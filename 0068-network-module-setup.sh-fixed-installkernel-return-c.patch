From 25bbb88eb5da3b5b81e735e97bdd5860e8d26d5e Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Fri, 22 Jun 2012 15:24:28 +0200
Subject: [PATCH] network/module-setup.sh: fixed installkernel() return code

---
 modules.d/40network/module-setup.sh |    6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/modules.d/40network/module-setup.sh b/modules.d/40network/module-setup.sh
index efe0511..c764bef 100755
--- a/modules.d/40network/module-setup.sh
+++ b/modules.d/40network/module-setup.sh
@@ -4,7 +4,6 @@
 
 check() {
     local _program
-    . $dracutfunctions
 
     for _program in ip arping dhclient ; do
         if ! type -P $_program >/dev/null; then
@@ -43,6 +42,7 @@ installkernel() {
                 && ! $_fcont =~ iw_handler_get_spy ]] \
                 && echo "$_fname"
             done
+            return 0
         }
         function rotor() {
             local _f1 _f2
@@ -52,13 +52,13 @@ installkernel() {
                     echo "$_f2" 1>&${_side2}
                 fi
             done | nmf1 1>&${_merge}
+            return 0
         }
         # Use two parallel streams to filter alternating modules.
         set +x
         eval "( ( rotor ) ${_side2}>&1 | nmf1 ) ${_merge}>&1"
-        _ret=$?
         [[ $debug ]] && set -x
-        return $_ret
+        return 0
     }
 
     { find_kernel_modules_by_path drivers/net; find_kernel_modules_by_path drivers/s390/net; } \

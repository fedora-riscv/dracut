From c2ab99093817d4694c0360b77845b8f2a8a10caf Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Mon, 11 Nov 2013 16:57:09 +0100
Subject: [PATCH] iscsi,nbd: do not fail in hostonly mode

---
 modules.d/95iscsi/module-setup.sh | 2 +-
 modules.d/95nbd/module-setup.sh   | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/modules.d/95iscsi/module-setup.sh b/modules.d/95iscsi/module-setup.sh
index c8051bd..8379f4b 100755
--- a/modules.d/95iscsi/module-setup.sh
+++ b/modules.d/95iscsi/module-setup.sh
@@ -24,7 +24,7 @@ check() {
 
     [[ $hostonly ]] || [[ $mount_needs ]] && {
         pushd . >/dev/null
-        for_each_host_dev_and_slaves is_iscsi || return 1
+        for_each_host_dev_and_slaves is_iscsi || return 255
         popd >/dev/null
     }
     return 0
diff --git a/modules.d/95nbd/module-setup.sh b/modules.d/95nbd/module-setup.sh
index ac30823..37ace21 100755
--- a/modules.d/95nbd/module-setup.sh
+++ b/modules.d/95nbd/module-setup.sh
@@ -15,7 +15,7 @@ check() {
 
         _rootdev=$(find_root_block_device)
         [[ -b /dev/block/$_rootdev ]] || return 1
-        check_block_and_slaves is_nbd "$_rootdev" || return 1
+        check_block_and_slaves is_nbd "$_rootdev" || return 255
     }
 
     return 0

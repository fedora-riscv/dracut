From 93643c8cef61d9df4688052752029b0b518c71da Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Tue, 12 Jun 2012 14:36:34 +0200
Subject: [PATCH] Revert "network/ifup.sh: do not default to dhcp, for
 interfaces without ip=..."

This reverts commit 588f0347536f3668708131353b2cb01f21594b59.
---
 modules.d/40network/ifup.sh | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/modules.d/40network/ifup.sh b/modules.d/40network/ifup.sh
index b8f07f4..2111b41 100755
--- a/modules.d/40network/ifup.sh
+++ b/modules.d/40network/ifup.sh
@@ -202,6 +202,17 @@ if [ "$netif" = "$bridgename" ] && [ ! -e /tmp/net.$bridgename.up ]; then
     brctl addif $bridgename $ethname
 fi
 
+# No ip lines default to dhcp
+ip=$(getarg ip)
+
+if [ -z "$ip" ]; then
+    if [ "$netroot" = "dhcp6" ]; then
+        do_dhcp -6
+    else
+        do_dhcp -4
+    fi
+fi
+
 # Specific configuration, spin through the kernel command line
 # looking for ip= lines
 for p in $(getargs ip=); do

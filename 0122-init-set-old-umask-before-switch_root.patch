From 957144aa800ba044af38563b0b5fd083beb7d226 Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Mon, 2 Aug 2010 11:28:16 +0200
Subject: [PATCH 122/133] init: set old umask before switch_root

---
 modules.d/99base/init |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/modules.d/99base/init b/modules.d/99base/init
index 2870e2a..2a376dd 100755
--- a/modules.d/99base/init
+++ b/modules.d/99base/init
@@ -63,6 +63,7 @@ NEWROOT="/sysroot"
 
 trap "emergency_shell Signal caught!" 0
 # set umask
+OLD_UMASK=$(umask)
 umask 0007
 
 RDDEBUG=""
@@ -314,6 +315,8 @@ info "Switching root"
 
 wait_for_loginit
 
+umask $OLD_UMASK
+
 exec switch_root "$NEWROOT" "$INIT" $initargs || {
     echo "Something went very badly wrong in the initramfs.  Please "
     echo "file a bug against dracut."
-- 
1.7.3


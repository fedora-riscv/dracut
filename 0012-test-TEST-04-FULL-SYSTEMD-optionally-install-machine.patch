From b8bccd398a4214376474c330ee4b756a4d0c1d19 Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Mon, 14 Dec 2015 15:12:24 +0100
Subject: [PATCH] test/TEST-04-FULL-SYSTEMD: optionally install machine-info
 and *-id

---
 test/TEST-04-FULL-SYSTEMD/test.sh | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/test/TEST-04-FULL-SYSTEMD/test.sh b/test/TEST-04-FULL-SYSTEMD/test.sh
index 6ea9281..f5a9d48 100755
--- a/test/TEST-04-FULL-SYSTEMD/test.sh
+++ b/test/TEST-04-FULL-SYSTEMD/test.sh
@@ -264,9 +264,13 @@ EOF
 	inst_hook emergency 000 ./hard-off.sh
 	inst_simple ./99-idesymlinks.rules /etc/udev/rules.d/99-idesymlinks.rules
     )
+
+    [ -e /etc/machine-id ] && EXTRA_MACHINE="/etc/machine-id"
+    [ -e /etc/machine-info ] && EXTRA_MACHINE+=" /etc/machine-info"
+
     sudo $basedir/dracut.sh -l -i $TESTDIR/overlay / \
 	-a "debug systemd i18n" \
-	-I "/etc/machine-id /etc/hostname" \
+	${EXTRA_MACHINE:+-I "$EXTRA_MACHINE"} \
         -o "dash network plymouth lvm mdraid resume crypt caps dm terminfo usrmount kernel-network-modules" \
 	-d "piix ide-gd_mod ata_piix btrfs sd_mod i6300esb ib700wdt" \
         --no-hostonly-cmdline -N \

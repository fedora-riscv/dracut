From 3dbf1f078357867b289ec58138fe134e7e99762e Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@hoyer.xyz>
Date: Wed, 13 Dec 2017 08:51:12 +0100
Subject: [PATCH] Merge pull request #313 from danimo/amd-family0x17

Support Microcode Updates for AMD CPU Family 0x17
---
 dracut-functions.sh | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/dracut-functions.sh b/dracut-functions.sh
index 575bd4a6..642dcf09 100755
--- a/dracut-functions.sh
+++ b/dracut-functions.sh
@@ -662,8 +662,10 @@ get_ucode_file ()
     local stepping=`grep -E "stepping" /proc/cpuinfo | head -1 | sed s/.*:\ //`
 
     if [[ "$(get_cpu_vendor)" == "AMD" ]]; then
-        # If family greater than or equal to 0x16
-        if [[ $family -ge 22 ]]; then
+        # If family greater than or equal to 0x17
+        if [[ $family -ge 23 ]]; then
+            printf "microcode_amd_fam17h.bin"
+        elif [[ $family -eq 22 ]]; then
             printf "microcode_amd_fam16h.bin"
         elif [[ $family -eq 21 ]]; then
             printf "microcode_amd_fam15h.bin"

